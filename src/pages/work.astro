---
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";
import Card from "../components/Card.astro";
import { imageMap } from "../lib/images";

const projects = await getCollection("projects");
const sortedProjects = projects.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<Layout title="Charles E. Amyx, III - Work">
  <section
    class="container mx-auto px-4 pt-12 md:pt-16 lg:pt-24 pb-12 md:pb-10 lg:pb-12"
  >
    <h1 class="text-3xl font-semibold mb-8">My Work</h1>
    <ul class="grid grid-cols-1 md:grid-cols-4 lg:grid-cols-3 gap-8">
      {
        sortedProjects.map((project) => {
          const imageModule = project.data.image
            ? imageMap[project.data.image]
            : undefined;
          if (!imageModule) return null;
          return (
            <li>
              <Card
                href={`/work/${project.slug}`}
                title={project.data.title}
                image={imageModule}
                type={project.data.type || ""}
              />
            </li>
          );
        })
      }
    </ul>
  </section>
</Layout>
